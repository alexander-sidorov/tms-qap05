name: Contributing

on:
  pull_request:
  workflow_dispatch:
    inputs:
      bypassToken:
        description: "Bypass token (ask Alexander)"
        required: false

jobs:
  contributing:
    runs-on: "ubuntu-latest"
    steps:
      - name: '🧱 The code is pulled from the repository.'
        uses: actions/checkout@v2
      - name: '📊 The diff is calculated.'
        id: get-diff
        uses: technote-space/get-diff-action@v5
      - name: '🍻 The contributor does his/her job well.'
        env:
          CONTRIBUTING_BYPASS_TOKEN: ${{ secrets.CONTRIBUTING_BYPASS_TOKEN }}
        if: ${{ github.event.inputs.bypassToken != env.CONTRIBUTING_BYPASS_TOKEN }}
        run: >
          .github/scripts/check_contributor.sh
          '${{ github.event.pull_request.user.login }}'
          '${{ github.event.pull_request.title }}'
          ${{steps.get-diff.outputs.diff}}
